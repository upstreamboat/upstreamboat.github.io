{"title":"库--casbin","uid":"d7434239378216dfafb37dc4b2b89c73","slug":"GO语言/基础/库--casbin","date":"2024-10-12T02:26:58.632Z","updated":"2024-10-19T08:24:13.211Z","comments":true,"path":"api/articles/GO语言/基础/库--casbin.json","keywords":null,"cover":"/images/cover/5.png","content":"<h1 id=\"库–casbin\"><a href=\"#库–casbin\" class=\"headerlink\" title=\"库–casbin\"></a>库–casbin</h1><ol>\n<li><p>创建权限配置来源 adapter（db 或者 file）</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">adapter, err := gormadapter.NewAdapterByDB(global.App.DB)</span><br></pre></td></tr></table></figure></li>\n<li><p>创建配置模板 model（file 或者模板字符串）</p>\n<p> 方法一：模板字符串</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">model,err:=model.NewModelFromString(<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">[request_definition]</span></span><br><span class=\"line\"><span class=\"string\">r=sub,obj,act</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[policy_definition]</span></span><br><span class=\"line\"><span class=\"string\">p=sub,obj,act</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[policy_effect]</span></span><br><span class=\"line\"><span class=\"string\">e=some(where(p.eft==allow))</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">[matchers]</span></span><br><span class=\"line\"><span class=\"string\">m=r.sub==p.sub&amp;&amp;r.obj==p.obj&amp;&amp;r.act==p.act</span></span><br><span class=\"line\"><span class=\"string\">`</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">e,_=casbin.NewEnforcer(model,adapter)</span><br></pre></td></tr></table></figure>\n\n<p> 方法二：文件<br>  创建<code>examples/rbac_model.conf</code>文件，将上述模板字符串写在文件中</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">e, _ = casbin.NewEnforcer(<span class=\"string\">&quot;examples/rbac_model.conf&quot;</span>, adapter)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>使用</p>\n <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Load the policy from DB.</span></span><br><span class=\"line\">e.LoadPolicy()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Check the permission.</span></span><br><span class=\"line\"><span class=\"comment\">//e.Enforce(&quot;alice&quot;, &quot;data1&quot;, &quot;read&quot;)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Modify the policy.</span></span><br><span class=\"line\"><span class=\"comment\">// e.AddPolicy(...)</span></span><br><span class=\"line\"><span class=\"comment\">// e.RemovePolicy(...)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Save the policy back to DB.</span></span><br><span class=\"line\"><span class=\"comment\">//e.SavePolicy()</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n","text":"库–casbin 创建权限配置来源 adapter（db 或者 file） 1adapter, err := gormadapter.NewAdapterByD...","permalink":"/post/GO语言/基础/库--casbin","photos":[],"count_time":{"symbolsCount":800,"symbolsTime":"1 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%BA%93%E2%80%93casbin\"><span class=\"toc-text\">库–casbin</span></a></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"库--zap","uid":"41abb34d9ed07e2f1a572226070d62d0","slug":"GO语言/基础/库--zap","date":"2024-10-12T02:26:58.682Z","updated":"2024-10-19T08:24:15.497Z","comments":true,"path":"api/articles/GO语言/基础/库--zap.json","keywords":null,"cover":"/images/cover/5.png","text":"库–zap无需细究内容，需要使用 zap 时直接复制即可 123456789101112131415161718192021222324252627282930...","permalink":"/post/GO语言/基础/库--zap","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"Gorm","uid":"2a28425a1a7d4e14f42cf293b79ac333","slug":"GO语言/基础/Gorm","date":"2024-10-12T02:26:58.608Z","updated":"2024-10-19T08:24:11.029Z","comments":true,"path":"api/articles/GO语言/基础/Gorm.json","keywords":null,"cover":"/images/cover/5.png","text":"Gorm sql 预加载 Preload()函数可以优化查询性能，怎么优化的？Preload()：用于查询数据库中有关联的表。会在查询时，将关联表的数据一并查出...","permalink":"/post/GO语言/基础/Gorm","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"9 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}