{"title":"目录相关实例","uid":"e7d194280cea056de0f746d5c82db848","slug":"GO语言/运用/目录相关实例","date":"2024-10-12T02:28:09.284Z","updated":"2024-10-19T08:25:59.766Z","comments":true,"path":"api/articles/GO语言/运用/目录相关实例.json","keywords":null,"cover":"/images/cover/5.png","content":"<h1 id=\"目录相关实例\"><a href=\"#目录相关实例\" class=\"headerlink\" title=\"目录相关实例\"></a>目录相关实例</h1><ul>\n<li>遍历目录下的文件，但不遍历子目录</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;fmt&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;os&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">&quot;path/filepath&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    rootDir := <span class=\"string\">&quot;./your_directory&quot;</span> <span class=\"comment\">// 替换为你要遍历的目录</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 打开指定目录</span></span><br><span class=\"line\"></span><br><span class=\"line\">    entries, err := os.ReadDir(rootDir)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        fmt.Println(<span class=\"string\">&quot;Error:&quot;</span>, err)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> _, entry := <span class=\"keyword\">range</span> entries &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 仅处理文件，排除目录</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> !entry.IsDir() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            fmt.Println(filepath.Join(rootDir, entry.Name())) <span class=\"comment\">// 打印文件路径</span></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>确保目录存在</li>\n</ul>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// EnsureDir 检查目录是否存在，如果不存在则创建该目录</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">EnsureDir</span><span class=\"params\">(path <span class=\"type\">string</span>)</span></span> <span class=\"type\">error</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        fi, err := os.Stat(path)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> err == <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 如果是目录，直接返回</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> fi.IsDir() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span> <span class=\"comment\">// 目录存在</span></span><br><span class=\"line\"></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 目录不存在，但是存在同名文件</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">return</span> errors.New(<span class=\"string\">&quot;存在同名文件，无法创建目录&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> os.IsNotExist(err) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 目录不存在，尝试创建</span></span><br><span class=\"line\"></span><br><span class=\"line\">                err := os.MkdirAll(path, os.ModePerm) <span class=\"comment\">// 创建目录</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"keyword\">return</span> err <span class=\"comment\">// 返回创建目录时的错误</span></span><br><span class=\"line\"></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span> <span class=\"comment\">// 成功处理</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","text":"目录相关实例 遍历目录下的文件，但不遍历子目录 12345678910111213141516171819202122232425262728293031323...","permalink":"/post/GO语言/运用/目录相关实例","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":158,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%9B%AE%E5%BD%95%E7%9B%B8%E5%85%B3%E5%AE%9E%E4%BE%8B\"><span class=\"toc-text\">目录相关实例</span></a></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon_2.jfif","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"有默认值的结构体","uid":"65fc3bead86a0d6e48bba450457036ac","slug":"GO语言/运用/有默认值的结构体","date":"2024-10-12T02:28:09.313Z","updated":"2024-10-19T08:26:01.505Z","comments":true,"path":"api/articles/GO语言/运用/有默认值的结构体.json","keywords":null,"cover":"/images/cover/5.png","text":"有默认值的结构体123456789101112131415161718192021222324252627282930313233343536373839404...","permalink":"/post/GO语言/运用/有默认值的结构体","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":158,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon_2.jfif","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"易错知识","uid":"35abbd806d5efafaff1901d4654f89d1","slug":"GO语言/运用/易错知识","date":"2024-10-12T02:28:09.260Z","updated":"2024-10-19T08:25:58.010Z","comments":true,"path":"api/articles/GO语言/运用/易错知识.json","keywords":null,"cover":"/images/cover/5.png","text":"易错知识 strings.Clone 12345678910111213141516171819// 假设输入的log长度为1000字节// uuid新分配了3...","permalink":"/post/GO语言/运用/易错知识","photos":[],"count_time":{"symbolsCount":520,"symbolsTime":"1 mins."},"categories":[{"name":"GO语言","slug":"GO语言","count":77,"path":"api/categories/GO语言.json"}],"tags":[{"name":"技术","slug":"技术","count":158,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon_2.jfif","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}