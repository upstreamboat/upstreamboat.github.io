{"title":"跨域解决","uid":"36e5890aed92c11d2d4ce54bc8178724","slug":"杂学/前端/跨域解决","date":"2024-10-11T07:39:13.117Z","updated":"2024-10-19T08:19:40.667Z","comments":true,"path":"api/articles/杂学/前端/跨域解决.json","keywords":null,"cover":"/images/cover/4.png","content":"<h2 id=\"是什么\"><a href=\"#是什么\" class=\"headerlink\" title=\"是什么\"></a>是什么</h2><p>因为浏览器的同源策略（同协议、ip、port 为同源），导致不同域名不能相互访问。</p>\n<ol>\n<li>法一：vue 使用代理解决</li>\n</ol>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vite.config.ts</span></span><br><span class=\"line\"><span class=\"attr\">server</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">host</span>: <span class=\"string\">&#x27;0.0.0.0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">proxy</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;/api&#x27;</span>: &#123; <span class=\"comment\">// 拦截所有/api开头的请求</span></span><br><span class=\"line\">        <span class=\"attr\">target</span>: <span class=\"string\">&quot; [http://localhost:8088](http://localhost:8088)&quot;</span>,  <span class=\"comment\">// 转发到该地址</span></span><br><span class=\"line\">        <span class=\"attr\">changeOrigin</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 允许跨域</span></span><br><span class=\"line\">        <span class=\"attr\">rewrite</span>: <span class=\"function\"><span class=\"params\">path</span> =&gt;</span> path.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^\\/api/</span>,<span class=\"string\">&#x27;&#x27;</span>), <span class=\"comment\">// 去除/api</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>法二：后端使用 cors 库解决</li>\n</ol>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//  cors.go</span></span><br><span class=\"line\"><span class=\"keyword\">package</span> middleware</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;github.com/gin-contrib/cors&quot;</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Cors</span><span class=\"params\">()</span></span> gin.HandlerFunc &#123;</span><br><span class=\"line\">\tconfig := cors.DefaultConfig()</span><br><span class=\"line\">\tconfig.AllowAllOrigins = <span class=\"literal\">true</span></span><br><span class=\"line\">\tconfig.AllowHeaders = []<span class=\"type\">string</span>&#123;<span class=\"string\">&quot;Origin&quot;</span>, <span class=\"string\">&quot;Content-Length&quot;</span>, <span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;Authorization&quot;</span>&#125;</span><br><span class=\"line\">\tconfig.AllowCredentials = <span class=\"literal\">true</span></span><br><span class=\"line\">\tconfig.ExposeHeaders = []<span class=\"type\">string</span>&#123;<span class=\"string\">&quot;New-Token&quot;</span>, <span class=\"string\">&quot;New-Expires-In&quot;</span>, <span class=\"string\">&quot;Content-Disposition&quot;</span>&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> cors.New(config)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// router.go</span></span><br><span class=\"line\">router.Use(middleware.Cors()) <span class=\"comment\">// 启用cors中间件</span></span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>法三：nginx 在 location 内配置 header 解决</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// nginx.conf</span><br><span class=\"line\">add_header &#x27;Access-Control-Allow-Origin&#x27; &#x27;*&#x27;;</span><br></pre></td></tr></table></figure>\n","text":"是什么因为浏览器的同源策略（同协议、ip、port 为同源），导致不同域名不能相互访问。 法一：vue 使用代理解决 1234567891011// vite....","permalink":"/post/杂学/前端/跨域解决","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"前端","slug":"前端","count":14,"path":"api/categories/前端.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%98%AF%E4%BB%80%E4%B9%88\"><span class=\"toc-text\">是什么</span></a></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"undefined、null","uid":"0726a6e1355297f3b351bff13d2e7663","slug":"杂学/前端/undefined、null","date":"2024-10-11T07:45:00.339Z","updated":"2024-10-19T08:19:42.827Z","comments":true,"path":"api/articles/杂学/前端/undefined、null.json","keywords":null,"cover":"/images/cover/4.png","text":"undefined基本类型，表示变量已声明但未赋值、或对象的属性不存在 123456// 自动赋值为 undefinedlet a;console.log(a)...","permalink":"/post/杂学/前端/undefined、null","photos":[],"count_time":{"symbolsCount":274,"symbolsTime":"1 mins."},"categories":[{"name":"前端","slug":"前端","count":14,"path":"api/categories/前端.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"axios","uid":"33876cf3e210da358d8e4b065eea88e6","slug":"杂学/前端/axios","date":"2024-10-11T07:34:32.394Z","updated":"2024-10-19T08:19:38.102Z","comments":true,"path":"api/articles/杂学/前端/axios.json","keywords":null,"cover":"/images/cover/4.png","text":" 代码 123456789101112131415161718192021222324252627282930313233343536373839async f...","permalink":"/post/杂学/前端/axios","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"前端","slug":"前端","count":14,"path":"api/categories/前端.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}