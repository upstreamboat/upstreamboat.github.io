{"title":"linux-03-shell脚本","uid":"0a174f27aab9bc96fb6b45bb12b6fd32","slug":"命令/linux/linux-03-shell脚本","date":"2024-10-12T08:40:34.840Z","updated":"2024-10-19T08:16:10.272Z","comments":true,"path":"api/articles/命令/linux/linux-03-shell脚本.json","keywords":null,"cover":"/images/cover/7.png","content":"<h1 id=\"linux-03-shell-脚本\"><a href=\"#linux-03-shell-脚本\" class=\"headerlink\" title=\"linux-03-shell 脚本\"></a>linux-03-shell 脚本</h1><h2 id=\"shell-脚本\"><a href=\"#shell-脚本\" class=\"headerlink\" title=\"shell 脚本\"></a>shell 脚本</h2><p>局部变量仅在当前 shell 中可以访问；全局变量在父子 shell 中都可以访问<br>但是，子 shell 中的更改，在父 shell 中不生效（类似于 go 的值传递，作用域随着子 shell 的关闭而消失）</p>\n<h3 id=\"执行-shell-脚本的方法\"><a href=\"#执行-shell-脚本的方法\" class=\"headerlink\" title=\"执行 shell 脚本的方法\"></a>执行 shell 脚本的方法</h3><ol>\n<li><code>source xxx.sh</code>（等价于. xxx.sh（空格不能少））<br>在当前 shell 进程中执行脚本</li>\n<li><code>sh xxx.sh</code>（等价于 bash xxx.sh（因为 sh 是连接到 bash 的））<br>开启一个子 shell，在子 shell 中执行脚本。<br>因为是在子 shell 中，所以创建或修改的变量，回到父 shell 后不生效</li>\n<li><code>./xxx.sh</code><br>开启一个子 shell，在子 shell 中执行脚本，但是需要先赋予脚本可执行权限</li>\n</ol>\n<h2 id=\"的使用\"><a href=\"#的使用\" class=\"headerlink\" title=\"$的使用\"></a>$的使用</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$var：调用变量</span><br><span class=\"line\">$n：获取命令的第几个参数。$0是命令本身</span><br><span class=\"line\">$#：获取参数个数。包含本身吗？</span><br><span class=\"line\">$*：获取所有的参数作为一个整体</span><br><span class=\"line\">$@：获取所有的参数作为多个参数</span><br><span class=\"line\">$?：获取上一个命令的执行是否成功（0：成功；1：失败）</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"语法\"><a href=\"#语法\" class=\"headerlink\" title=\"语法\"></a>语法</h2><ul>\n<li><p>计算表达式的值</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo $[1+2]</span><br><span class=\"line\">echo $((1+2))</span><br><span class=\"line\">echo $(expr 1 \\* 2)</span><br><span class=\"line\">echo `expr 1 \\* 2`</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>条件判断</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ 2 = 2 ]</span><br><span class=\"line\">[ 1 = 1 ] &amp;&amp; [ 2 = 2 ]</span><br><span class=\"line\">[ 2 = 3 ] &amp;&amp; echo &quot;true&quot; || echo &quot;false&quot;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>流程控制</p>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if</span><br><span class=\"line\">case</span><br><span class=\"line\">for</span><br><span class=\"line\">while</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>read 读取输入</p>\n  <figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">read -t <span class=\"number\">5</span> -p <span class=\"string\">&quot;your name: &quot;</span> NN</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>函数：略</p>\n</li>\n</ul>\n<h3 id=\"文本处理三剑客\"><a href=\"#文本处理三剑客\" class=\"headerlink\" title=\"文本处理三剑客\"></a>文本处理三剑客</h3><ol>\n<li><p>cut：文本内容剪切<br>-d：指定分隔符<br>-f：指定获取第几部分</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cut test.txt -d <span class=\"string\">&quot; &quot;</span> -f <span class=\"number\">1</span></span><br><span class=\"line\">cat /etc/passwd |grep bash$|cut -d <span class=\"string\">&quot;/&quot;</span> -f <span class=\"number\">1</span>-</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>awk：文本内容处理<br>格式：<code>awk -F &quot;分隔符&quot; &#39;/正则表达式/&#123;执行语句&#125;&#39;</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 默认以空格分隔</span><br><span class=\"line\">cat /etc/passwd |awk &#x27;&#123;print $1&#125;&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">// -F：指定分隔符</span><br><span class=\"line\">cat /etc/passwd |awk -F &quot;:&quot; &#x27;&#123;print $6&quot;,&quot;$7&#125;&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">// 匹配文件中以root开头的行</span><br><span class=\"line\">cat /etc/passwd |awk -F &quot;:&quot; &#x27;/^root/&#123;print $6$7&#125;&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">// 显示结果中添加首尾行信息</span><br><span class=\"line\">cat /etc/passwd |awk -F &quot;:&quot; BEGIN&#123;print &quot;begin&quot;&#125; &#x27;&#123;print $1&quot;,&quot;$7&#125;&#x27; END&#123;print &quot;end&quot;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// -v 定义变量</span><br><span class=\"line\">cat /etc/passwd |awk -v i=2 -F &quot;:&quot; &#x27;&#123;print $3+i&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// 系统内置变量：文件名、行号、分隔后的列数</span><br><span class=\"line\">awk &#x27;&#123;print FILENAME&quot;,&quot;NR&quot;,&quot;NF&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>sed：文本内容增删改</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Hello替换成Hi</span><br><span class=\"line\">// s：表示替换操作；g：表示全部替换</span><br><span class=\"line\">sed &#x27;s/Hello/Hi/g&#x27; data.txt</span><br></pre></td></tr></table></figure></li>\n</ol>\n","text":"linux-03-shell 脚本shell 脚本局部变量仅在当前 shell 中可以访问；全局变量在父子 shell 中都可以访问但是，子 shell 中的更...","permalink":"/post/命令/linux/linux-03-shell脚本","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"命令","slug":"命令","count":15,"path":"api/categories/命令.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#linux-03-shell-%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">linux-03-shell 脚本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#shell-%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">shell 脚本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%A7%E8%A1%8C-shell-%E8%84%9A%E6%9C%AC%E7%9A%84%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">执行 shell 脚本的方法</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9A%84%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">$的使用</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AF%AD%E6%B3%95\"><span class=\"toc-text\">语法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E4%B8%89%E5%89%91%E5%AE%A2\"><span class=\"toc-text\">文本处理三剑客</span></a></li></ol></li></ol></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"linux-04-软硬链接","uid":"b4bdc08e8683d28fc8919e60c11f9d85","slug":"命令/linux/linux-04-软硬链接","date":"2024-10-12T08:40:34.854Z","updated":"2024-10-19T08:16:04.084Z","comments":true,"path":"api/articles/命令/linux/linux-04-软硬链接.json","keywords":null,"cover":"/images/cover/7.png","text":"linux-04-软硬链接 特点： 源文件、软链接、硬链接，一改具改。 删除源文件只会对软链接文件有影响。 因为源文件和硬链接指向的都是内存中的文件节点，而软链...","permalink":"/post/命令/linux/linux-04-软硬链接","photos":[],"count_time":{"symbolsCount":212,"symbolsTime":"1 mins."},"categories":[{"name":"命令","slug":"命令","count":15,"path":"api/categories/命令.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"linux-02-命令","uid":"9a4dc773c6431e348c90624ba1cd5533","slug":"命令/linux/linux-02-命令","date":"2024-10-12T08:40:34.804Z","updated":"2024-10-19T08:15:58.865Z","comments":true,"path":"api/articles/命令/linux/linux-02-命令.json","keywords":null,"cover":"/images/cover/7.png","text":"linux-02-命令 A B which + 命令 查看命令在哪 systemctl start + 服务 启动服务 find / -name file 查找...","permalink":"/post/命令/linux/linux-02-命令","photos":[],"count_time":{"symbolsCount":159,"symbolsTime":"1 mins."},"categories":[{"name":"命令","slug":"命令","count":15,"path":"api/categories/命令.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}