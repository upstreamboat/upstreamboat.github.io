{"title":"","type":"page","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"/* 脚本功能：清除指定文件夹下的所有文件的头部信息 */ // 获取所有笔记 const files = app.vault.getFiles(); // 指定需要清理头部属性的文件夹 const targetFolder = \"test/\"; files.forEach(fi...","date":"2024-10-15T09:44:47.951Z","updated":"2024-10-15T09:44:47.951Z","comments":true,"path":"api/pages/scripts/delete_head_info.js","covers":null,"content":"/*\n    脚本功能：清除指定文件夹下的所有文件的头部信息\n*/\n\n// 获取所有笔记\nconst files = app.vault.getFiles();\n\n// 指定需要清理头部属性的文件夹\nconst targetFolder = \"test/\";\n\nfiles.forEach(file => {\n    // 检查文件是否在目标文件夹内\n    if (file.path.startsWith(targetFolder) && file.extension === \"md\") {\n        // 读取当前文件内容\n        app.vault.read(file).then(fileContent => {\n            const lines = fileContent.split(\"\\n\");\n            let bodyContent = \"\";\n\n            // 找到最后一个头属性结束的位置\n            const headerEndIndex = lines.lastIndexOf(\"---\");\n            if (headerEndIndex !== -1) {\n                // 仅保留头部结束符之后的内容\n                bodyContent = lines.slice(headerEndIndex + 1).join(\"\\n\").trim();\n            } else {\n                bodyContent = fileContent; // 如果没有头部，保留原内容\n            }\n\n            // 写回文件\n            app.vault.modify(file, bodyContent).then(() => {\n                // 自动保存文件，直接确保保存操作\n                console.log(`更新成功: ${file.path}`);\n            }).catch(err => {\n                console.error(`写回文件失败: ${file.path}, 错误: ${err}`);\n            });\n        }).catch(err => {\n            console.error(`读取文件失败: ${file.path}, 错误: ${err}`);\n        });\n    }\n});\n","count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"toc":"","data":[]}