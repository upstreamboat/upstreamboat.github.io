{"title":"redis","uid":"eb5f3adb17521be888d5fac1c7b84dc0","slug":"杂学/未分类/redis","date":"2024-10-09T02:09:35.632Z","updated":"2024-10-19T08:21:29.331Z","comments":true,"path":"api/articles/杂学/未分类/redis.json","keywords":null,"cover":"/images/cover/1.png","content":"<h1 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h1><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>nosql，非关系型数据库<br>数据以 键值对 形式存储在 内存 中</p>\n<blockquote>\n<p>值的类型：字符串(String)、哈希(Hash)、列表(list)、集合(sets)、有序集合(sorted sets)等<br><code>一个 string 类型的值最大能存储 512MB</code></p></blockquote>\n</blockquote>\n<h1 id=\"特点\"><a href=\"#特点\" class=\"headerlink\" title=\"特点\"></a>特点</h1><ul>\n<li><p><strong>支持事务</strong>：不是原子性的，只是批量的命令执行，命令出错不会影响下一个命令</p>\n</li>\n<li><p><strong>支持设置过期时间</strong>，可以减少大量占用内存空间</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>减少内存空间占用的策略：定期删除 + 惰性删除 + 内存淘汰</p>\n<blockquote>\n<ol>\n<li>定期删除：定期随机选择一部分数据，删除其中过期时间到达的数据<br>弊端：有些数据过期时间很长；有些已过期数据始终不被随机选中</li>\n<li>惰性删除：数据被查询时，若过期时间到达则删除<br>弊端：有些始终不被查询的数据会被忽略</li>\n<li>内存淘汰：当内存不足时，给定一些方案（具体哪些方案略）让使用者去选择如何处理</li>\n</ol></blockquote>\n</blockquote>\n</li>\n<li><p><strong>支持持久化</strong>：可以将内存中的数据保存到磁盘中<br>  两种方式：</p>\n<ol>\n<li>RDB：多长时间内触发多少次更新（增删改）后，写入.rdb 文件</li>\n<li>AOF：每次更新都记录操作日志，在断电重启后，执行日志文件来恢复数据</li>\n</ol>\n</li>\n<li><p><strong>内置了发布&#x2F;订阅模式</strong></p>\n</li>\n<li><p><strong>单线程模型简化了并发控制的复杂性</strong></p>\n</li>\n<li><p><strong>高可用</strong>：</p>\n<ul>\n<li><p>主从复制：一个主节点有多个从节点，将主节点的数据复制给从节点，保持数据一致性。可以通过从节点来备份数据或分担读请求，提高数据的可用性和系统的伸缩性</p>\n</li>\n<li><p>哨兵模式：哨兵是 redis 中运行的一个线程，它有三个功能：</p>\n<ol>\n<li>监控：会不断地发送命令来检查节点是否正常</li>\n<li>通知：如果某节点挂了，哨兵会通过发布&#x2F;订阅模式通知其它节点</li>\n<li>故障转移：主节点挂了，会将一个子节点升为主节点，原来的主节点降为从节点</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"异常情况\"><a href=\"#异常情况\" class=\"headerlink\" title=\"异常情况\"></a>异常情况</h1><ul>\n<li><p><strong>缓存穿透</strong>：查询不存在的数据。因 redis 中不存在，便会去数据库找，但数据库中也不存在，所以本次请求后数据无法写入 redis，下一次请求还会继续越过 redis 去找数据库。</p>\n</li>\n<li><p><strong>缓存击穿</strong>：某热点数据（高访问频率数据）到期被删除，然后突然收到多个访问该数据的请求，因 redis 中已删除，故请求都会去到数据库中查找，redis 便失去了缓存的意义。</p>\n</li>\n<li><p><strong>缓存雪崩</strong>：缓存击穿的升级版，大量数据被删除，然后大量请求过来，直接把数据库干趴了。<br>  解决方案：过期时间均匀分布（随机生成过期时间） + 热点数据永不过期</p>\n</li>\n<li><p><a href=\"https://www.bilibili.com/video/BV1Fd4y1T7pD/?spm_id_from=333.788&vd_source=507d1879a78d5f28fa1ac6c38dbc28d0\">参考视频</a></p>\n</li>\n</ul>\n<h1 id=\"Redis-Pipeline\"><a href=\"#Redis-Pipeline\" class=\"headerlink\" title=\"Redis Pipeline\"></a>Redis Pipeline</h1><p><a href=\"%5Bhttps://segmentfault.com/a/1190000044298001%5D(https://segmentfault.com/a/1190000044298001)\">学习</a></p>\n<ul>\n<li>目的<br>  优化批量操作，将多个命令一次性发送，减少网络通信次数。但是服务端拿到 N 个命令后，还是依次执行的</li>\n<li>特点<br>  无法保证原子性</li>\n</ul>\n","text":"定义 nosql，非关系型数据库数据以 键值对 形式存储在 内存 中 值的类型：字符串(String)、哈希(Hash)、列表(list)、集合(sets)、有...","permalink":"/post/杂学/未分类/redis","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"未分类","slug":"未分类","count":25,"path":"api/categories/未分类.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%9A%E4%B9%89\"><span class=\"toc-text\">定义</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%89%B9%E7%82%B9\"><span class=\"toc-text\">特点</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5\"><span class=\"toc-text\">异常情况</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Redis-Pipeline\"><span class=\"toc-text\">Redis Pipeline</span></a></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"位移","uid":"d237b180598f612014a8905b584c2b3f","slug":"杂学/未分类/位移","date":"2024-10-09T02:09:35.633Z","updated":"2024-10-19T08:21:31.622Z","comments":true,"path":"api/articles/杂学/未分类/位移.json","keywords":null,"cover":"/images/cover/1.png","text":"左移运算一律在右端补 0，右移运算一律在左端补符号数(负数符号位为 1 就补 1，正数符号位为 0 就补 0) 在计算机内存当中，负数一律按照补码的形式进行存储...","permalink":"/post/杂学/未分类/位移","photos":[],"count_time":{"symbolsCount":168,"symbolsTime":"1 mins."},"categories":[{"name":"未分类","slug":"未分类","count":25,"path":"api/categories/未分类.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"Protobuf","uid":"3bbead949023bae81c3a3a0f1356f7e4","slug":"杂学/未分类/Protobuf","date":"2024-10-09T02:09:35.631Z","updated":"2024-10-19T08:21:27.747Z","comments":true,"path":"api/articles/杂学/未分类/Protobuf.json","keywords":null,"cover":"/images/cover/1.png","text":"定义Protocol Buffer 用于序列化结构化数据。和 json\\xml 最大的区别是：json\\xml 都是基于文本格式，ProtoBuf 是二进制格式...","permalink":"/post/杂学/未分类/Protobuf","photos":[],"count_time":{"symbolsCount":784,"symbolsTime":"1 mins."},"categories":[{"name":"未分类","slug":"未分类","count":25,"path":"api/categories/未分类.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}