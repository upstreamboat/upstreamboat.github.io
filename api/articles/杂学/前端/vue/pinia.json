{"title":"pinia","uid":"2a60f77314330572f365b0f5b003c4b8","slug":"杂学/前端/vue/pinia","date":"2024-10-12T01:49:22.361Z","updated":"2024-10-19T08:18:24.022Z","comments":true,"path":"api/articles/杂学/前端/vue/pinia.json","keywords":null,"cover":"/images/cover/8.png","content":"<h1 id=\"作用\"><a href=\"#作用\" class=\"headerlink\" title=\"作用\"></a>作用</h1><p>封装全局变量，用于组件间数据共享。因为是全局变量，一旦被修改，所有地方都变化</p>\n<h1 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h1><h2 id=\"1-创建-pinia\"><a href=\"#1-创建-pinia\" class=\"headerlink\" title=\"1. 创建 pinia\"></a>1. 创建 pinia</h2><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// count.ts</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; defineStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; ref &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> useCountStore = <span class=\"title function_\">defineStore</span>(<span class=\"string\">&#x27;count&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 这个&#x27;count&#x27;是该store的唯一标识，不可重复</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> sum = <span class=\"title function_\">ref</span>(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">updateSum</span>(<span class=\"params\"><span class=\"attr\">value</span>: <span class=\"built_in\">number</span></span>) &#123;</span><br><span class=\"line\">    sum.<span class=\"property\">value</span> += value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">computeSum</span>(<span class=\"params\"><span class=\"attr\">value</span>: <span class=\"built_in\">number</span></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum.<span class=\"property\">value</span> + value</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123; sum, updateSum, computeSum &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-启用-pinia\"><a href=\"#2-启用-pinia\" class=\"headerlink\" title=\"2. 启用 pinia\"></a>2. 启用 pinia</h2><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; createPinia &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"title function_\">createApp</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> pinia = <span class=\"title function_\">createPinia</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">use</span>(pinia)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-使用-pinia\"><a href=\"#3-使用-pinia\" class=\"headerlink\" title=\"3. 使用 pinia\"></a>3. 使用 pinia</h2><figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; useCountStore &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;@/stores/count&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; storeToRefs &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;pinia&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; useRouter &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-router&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> router = <span class=\"title function_\">useRouter</span>()</span><br><span class=\"line\"><span class=\"keyword\">const</span> countStore = <span class=\"title function_\">useCountStore</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 结构体赋值会丢失响应式，需要使用storeToRefs</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; sum &#125; = <span class=\"title function_\">storeToRefs</span>(countStore)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// countStore.$subscribe相当于watch()，当countStore内容变化时被调用。mutate是本次修改的信息，state是修改后的state</span></span><br><span class=\"line\">countStore.$subscribe(<span class=\"function\">(<span class=\"params\">mutate, state</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(mutate, state)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (sum.<span class=\"property\">value</span> &gt; <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">    router.<span class=\"title function_\">push</span>(<span class=\"string\">&#x27;/news&#x27;</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n","text":"作用封装全局变量，用于组件间数据共享。因为是全局变量，一旦被修改，所有地方都变化 用法1. 创建 pinia12345678910111213141516171...","permalink":"/post/杂学/前端/vue/pinia","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"vue","slug":"vue","count":15,"path":"api/categories/vue.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BD%9C%E7%94%A8\"><span class=\"toc-text\">作用</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%94%A8%E6%B3%95\"><span class=\"toc-text\">用法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%88%9B%E5%BB%BA-pinia\"><span class=\"toc-text\">1. 创建 pinia</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E5%90%AF%E7%94%A8-pinia\"><span class=\"toc-text\">2. 启用 pinia</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E4%BD%BF%E7%94%A8-pinia\"><span class=\"toc-text\">3. 使用 pinia</span></a></li></ol></li></ol>","author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"defineProps","uid":"9719ec2d673a403aa322d2f3381460fc","slug":"杂学/前端/vue/defineProps","date":"2024-10-12T01:52:51.211Z","updated":"2024-10-19T08:18:27.306Z","comments":true,"path":"api/articles/杂学/前端/vue/defineProps.json","keywords":null,"cover":"/images/cover/8.png","text":"作用：组件标签上元素，可以通过 defineProps()获得。 defineProps 可以接收普通组件标签的元素，也可以接收路由组件的参数（详见 route...","permalink":"/post/杂学/前端/vue/defineProps","photos":[],"count_time":{"symbolsCount":870,"symbolsTime":"1 mins."},"categories":[{"name":"vue","slug":"vue","count":15,"path":"api/categories/vue.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}},"next_post":{"title":"生命周期与钩子","uid":"dd5268e651fb95dca6972af9149bc813","slug":"杂学/前端/vue/生命周期与钩子","date":"2024-10-12T01:48:54.561Z","updated":"2024-10-19T08:18:21.463Z","comments":true,"path":"api/articles/杂学/前端/vue/生命周期与钩子.json","keywords":null,"cover":"/images/cover/8.png","text":"1234567891011onBeforeMount(()=>{})onMounted(()=>{})onBeforeUpdate(()=>{})onUpdat...","permalink":"/post/杂学/前端/vue/生命周期与钩子","photos":[],"count_time":{"symbolsCount":211,"symbolsTime":"1 mins."},"categories":[{"name":"vue","slug":"vue","count":15,"path":"api/categories/vue.json"}],"tags":[{"name":"技术","slug":"技术","count":168,"path":"api/tags/技术.json"}],"author":{"name":"upstreamboat","slug":"blog-author","avatar":"images/favicon/favicon.ico","link":"/","description":"nothing to say","socials":{"github":"https://github.com/upstreamboat","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/images/favicon/bilibili.svg","link":"https://www.bilibili.com/"},"chatgpt":{"icon":"/images/favicon/chatgpt.svg","link":"https://chatgpt.com/"}}}}}}